import{u as N,a as C,b as S,r as s,j as e}from"./app-DsbjyKGf.js";import{M as A,B as L}from"./monitor-layout-Dq_xIMSU.js";import{S as M}from"./search-Ifj-fhqc.js";import{C as F}from"./clock-cCztJzz1.js";import{C as z}from"./server-Ca-qE3nK.js";import"./app-DiM3Qhuw.js";import"./x-8qECKafY.js";import"./createLucideIcon-BnSOlFpd.js";import"./activity-BRPubSy7.js";function O(){const{settings:D}=N(),{t:m}=C(),{currentBranch:a}=S().props,[u,g]=s.useState([]),[h,c]=s.useState(!0),[l,p]=s.useState(""),[r,b]=s.useState("all"),[i,j]=s.useState("all"),[n,v]=s.useState("all");s.useEffect(()=>{k()},[a?.id]);const k=async()=>{c(!0);try{let t="/api/alerts";a?.id&&a.id!=="all"?t=`/api/alerts?branch_id=${a.id}`:a?.id==="all"&&(t="/api/alerts");const d=await fetch(t,{credentials:"same-origin",headers:{Accept:"application/json"}});if(d.ok){const o=await d.json();g(o)}}catch(t){console.error("Error fetching alerts:",t)}finally{c(!1)}},x=u.filter(t=>{const d=t.title.toLowerCase().includes(l.toLowerCase())||t.message.toLowerCase().includes(l.toLowerCase())||t.device?.name.toLowerCase().includes(l.toLowerCase()),o=r==="all"||t.severity===r,w=i==="all"||t.status===i,y=n==="all"||t.category===n;return d&&o&&w&&y}),f=t=>{switch(t){case"critical":return"text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30";case"high":return"text-orange-600 dark:text-orange-400 bg-orange-100 dark:bg-orange-900/30";case"medium":return"text-yellow-600 dark:text-yellow-400 bg-yellow-100 dark:bg-yellow-900/30";case"low":return"text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/30";default:return"text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-900/30"}};return e.jsx(A,{title:m("alerts.title"),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-2xl sm:text-3xl font-bold text-transparent dark:from-white dark:to-slate-300",children:"Alert Management"}),e.jsxs("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-400",children:["Monitor and manage system alerts for ",a?.name||"all branches"]})]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(M,{className:"absolute left-3 top-1/2 size-5 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search alerts...",value:l,onChange:t=>p(t.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pl-10 pr-4 text-sm text-slate-900 dark:border-slate-700 dark:bg-slate-800 dark:text-white"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:n,onChange:t=>v(t.target.value),className:"rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"manual",children:"Manual"}),e.jsx("option",{value:"offline",children:"Offline"}),e.jsx("option",{value:"performance",children:"Performance"}),e.jsx("option",{value:"security",children:"Security"}),e.jsx("option",{value:"maintenance",children:"Maintenance"})]}),e.jsxs("select",{value:r,onChange:t=>b(t.target.value),className:"rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:i,onChange:t=>j(t.target.value),className:"rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"acknowledged",children:"Acknowledged"}),e.jsx("option",{value:"dismissed",children:"Dismissed"})]})]})]}),e.jsx("div",{className:"space-y-4",children:h?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto mb-4 size-12 animate-spin rounded-full border-4 border-slate-300 border-t-blue-600"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Loading alerts..."})]}):x.length===0?e.jsxs("div",{className:"rounded-2xl border border-slate-200/50 bg-white p-12 text-center shadow-lg dark:border-slate-700/50 dark:bg-slate-800",children:[e.jsx(L,{className:"mx-auto mb-4 size-12 text-slate-400"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"No Alerts"}),e.jsx("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-400",children:l||r!=="all"||i!=="all"?"No alerts match your filters":"All systems operating normally"})]}):x.map(t=>e.jsx("div",{className:"rounded-xl border border-slate-200/50 bg-white p-6 shadow-lg transition-all hover:shadow-xl dark:border-slate-700/50 dark:bg-slate-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-medium ${f(t.severity)}`,children:t.severity.toUpperCase()}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:t.device?.name||"Unknown Device"})]}),e.jsx("h3",{className:"mt-3 text-lg font-semibold text-slate-900 dark:text-white",children:t.title}),e.jsx("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-400",children:t.message}),e.jsxs("div",{className:"mt-4 flex items-center gap-4 text-xs text-slate-500 dark:text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"size-3"}),new Date(t.triggered_at).toLocaleString()]}),t.downtime&&e.jsxs("div",{children:["Downtime: ",t.downtime]})]}),t.acknowledged&&e.jsx("div",{className:"mt-3 rounded-lg bg-blue-50 p-3 dark:bg-blue-950/20",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx(z,{className:"inline size-4 mr-1"}),"Acknowledged by ",t.acknowledged_by,t.reason&&`: ${t.reason}`]})})]}),e.jsx("div",{className:"ml-4",children:e.jsx("span",{className:`inline-flex rounded-full px-3 py-1 text-xs font-medium ${t.status==="active"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":t.status==="acknowledged"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}`,children:t.status})})]})},t.id))})]})})}export{O as default};
