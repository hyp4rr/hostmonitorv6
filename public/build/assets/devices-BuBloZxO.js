import{a as ls,b as rs,r as o,j as e,c as Me}from"./app-B4fkVL-W.js";import{b as ge,M as ns,C as A,a as xe,c as is}from"./monitor-layout-X6KElx1m.js";import{C as ds,g as ee}from"./device-icons-DptdtEPD.js";import{N as be,S as Ee,C as Ue}from"./server-DqELNAlQ.js";import{W as os}from"./wifi-DG7M9WHp.js";import{S as cs}from"./search-lVQvEiEL.js";import{R as Le}from"./refresh-cw-vpVBQ_Bj.js";import{A as xs}from"./activity-6clVTxZj.js";import{c as K}from"./createLucideIcon-dVGcEtEt.js";import{C as L}from"./chevron-up-D7DcPQoO.js";import{X as U,C as Pe}from"./x-BxlU8eWN.js";import{I as ms}from"./info-D-Bn7dWQ.js";import{T as me}from"./trending-up-BB1ZxGmM.js";import{C as H}from"./circle-alert-BLrgVcLv.js";import{U as ps}from"./user-BsYZnLKv.js";import{W as hs}from"./wifi-off-97JyGSU7.js";import"./app-hK0G8rfC.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],P=K("ArrowUpDown",us);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]],bs=K("Barcode",gs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],js=K("Grid3x3",fs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Ns=K("List",ks);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ws=K("Zap",vs),pe=i=>{if(i===0)return"0m";const u=i,d=Math.floor(u/60),p=Math.floor(d/24),f=Math.floor(p/7);if(f>0){const h=p%7;return h>0?`${f}w ${h}d`:`${f}w`}else if(p>0){const h=d%24;return h>0?`${p}d ${h}h`:`${p}d`}else if(d>0){const h=u%60;return h>0?`${d}h ${h}m`:`${d}h`}else return`${u}m`},ys=i=>{if(i===void 0||i<=0)return"0 minutes";const u=Math.ceil(i);if(u<60)return`${u} minute${u!==1?"s":""}`;const d=Math.floor(u/60),p=u%60;if(d<24)return p>0?`${d} hour${d!==1?"s":""} ${p} minute${p!==1?"s":""}`:`${d} hour${d!==1?"s":""}`;const f=Math.floor(d/24),h=d%24;return h>0?`${f} day${f!==1?"s":""} ${h} hour${h!==1?"s":""}`:`${f} day${f!==1?"s":""}`},he=[{id:"all",name:"All Devices",icon:be,count:0},{id:"switches",name:"Switch",icon:be,count:0,description:"Peralatan nadi utama rangkaian UTHM"},{id:"servers",name:"Server",icon:Ee,count:0,description:"Sistem aplikasi dan Web untuk kegunaan pengguna UTHM"},{id:"wifi",name:"WiFi",icon:os,count:0,description:"Kemudahan wifi yang disediakan untuk seluruh kawasan UTHM"},{id:"tas",name:"TAS",icon:ge,count:0,description:"Peralatan sistem kehadiran UTHM"},{id:"cctv",name:"CCTV",icon:ds,count:0,description:"Pemantauan CCTV"}],B=i=>{switch(i){case"online":return"text-green-600 dark:text-green-400";case"offline":return"text-red-600 dark:text-red-400";case"offline_ack":return"text-blue-600 dark:text-blue-400";case"warning":return"text-yellow-600 dark:text-yellow-400";default:return"text-gray-600 dark:text-gray-400"}},T=i=>{switch(i){case"online":return"bg-green-100 dark:bg-green-900/20";case"offline":return"bg-red-100 dark:bg-red-900/20";case"offline_ack":return"bg-blue-100 dark:bg-blue-900/20";case"warning":return"bg-yellow-100 dark:bg-yellow-900/20";default:return"bg-gray-100 dark:bg-gray-900/20"}},Ie=i=>{switch(i){case"online":return e.jsx(Ue,{className:"size-4"});case"offline":return e.jsx(hs,{className:"size-4"});case"offline_ack":return e.jsx(H,{className:"size-4"});case"warning":return e.jsx(H,{className:"size-4"});default:return e.jsx(H,{className:"size-4"})}},ue=i=>{switch(i){case"offline_ack":return"OFFLINE (ACK)";case"online":return"ONLINE";case"offline":return"OFFLINE";case"warning":return"WARNING";case"unknown":return"UNKNOWN";default:return"UNKNOWN"}};function qs(){console.log("Devices component rendering!");const{t:i}=ls(),{props:u}=rs(),{currentBranch:d}=u;console.log("Current Branch in render:",d);const[p,f]=o.useState("all"),[h,k]=o.useState(""),[$,J]=o.useState("all"),[x,I]=o.useState("all"),[g,O]=o.useState("all"),[N,R]=o.useState("all"),[y,se]=o.useState("all"),[t,D]=o.useState(null),[$s,fe]=o.useState(!1),je=o.useCallback(async s=>{try{fe(!0);const l=await fetch(`/api/devices/${s}`,{headers:{Accept:"application/json"},credentials:"same-origin"});if(l.ok){const n=await l.json();console.log("Loaded device details",n),D(b=>b&&b.id===s?n:b)}else console.warn("Failed to fetch device details",l.status)}catch(l){console.error("Failed to load device details",l)}finally{fe(!1)}},[]),[Q,ke]=o.useState("list"),[C,Be]=o.useState("name"),[z,Ne]=o.useState("asc"),[Z,Te]=o.useState(!1),[Oe,Re]=o.useState(new Set),[ve,Ve]=o.useState([]),[we,We]=o.useState([]),[te,qe]=o.useState([]),[ae,He]=o.useState([]),[ye,le]=o.useState([]),[Ke,re]=o.useState(!1),[X,ne]=o.useState(1),[Y,_e]=o.useState(300),[V,Je]=o.useState(0),[$e,Qe]=o.useState(1),[Ze,Xe]=o.useState({all:0,switches:0,servers:0,wifi:0,tas:0,cctv:0}),[ie,Se]=o.useState(!1),[de,Ce]=o.useState(null),[G,Ss]=o.useState(null),[m,W]=o.useState(()=>{try{const s=localStorage.getItem("deviceGridViewOptions");if(s)return JSON.parse(s)}catch{}return{showName:!1,showIp:!1,showStatus:!1,dense:!0,tiny:!1}});o.useEffect(()=>{try{localStorage.setItem("deviceGridViewOptions",JSON.stringify(m))}catch{}},[m]);const Ye=he.map(s=>({...s,count:Ze[s.id]||0})),F=o.useCallback(async()=>{console.log("fetchDevices called"),re(!0);try{const s=new URLSearchParams({page:X.toString(),per_page:Y.toString()});d?.id&&(d.id==="all"?s.append("branch_id","all"):s.append("branch_id",d.id.toString())),p!=="all"&&s.append("category",p),$!=="all"&&s.append("status",$),h&&s.append("search",h),x!=="all"&&s.append("location",x),g!=="all"&&s.append("brand",g),N!=="all"&&s.append("model",N),y!=="all"&&s.append("managed_by",y),s.append("sort_by",C),s.append("sort_order",z);const l=`/api/devices?${s.toString()}`;console.log("Fetching devices from:",l);const n=await fetch(l,{credentials:"same-origin",headers:{Accept:"application/json"},cache:"no-cache"});if(console.log("API Response status:",n.status),n.ok){const b=await n.json();if(console.log("API Response data:",b),b.pagination)console.log("Setting devices from paginated response:",b.data?.length||0),b.data&&b.data.length>0&&b.data.slice(0,3).forEach(a=>{console.log(`Device ${a.name}: uptime_minutes = ${a.uptime_minutes} (type: ${typeof a.uptime_minutes})`)}),le(b.data||[]),Je(b.pagination.total),Qe(b.pagination.last_page);else{const v=b.data||b;console.log("Setting devices from fallback response:",v.length),le(v)}}}catch(s){console.error("Error fetching devices:",s)}finally{re(!1)}},[X,Y,p,$,h,x,g,N,y,C,z,d?.id]),ze=o.useCallback(async()=>{try{let s="/api/devices?per_page=1";d?.id&&(d.id==="all"?s="/api/devices?branch_id=all&per_page=1":s=`/api/devices?branch_id=${d.id}&per_page=1`);const l=await fetch(s,{credentials:"same-origin",headers:{Accept:"application/json"}});if(l.ok){const n=await l.json();if(n.pagination){const v={all:n.pagination.total};for(const a of["switches","servers","wifi","tas","cctv"]){const r=await fetch(d?.id==="all"?`/api/devices?branch_id=all&category=${a}&per_page=1`:`/api/devices?branch_id=${d?.id}&category=${a}&per_page=1`,{credentials:"same-origin",headers:{Accept:"application/json"}});if(r.ok){const c=await r.json();v[a]=c.pagination?.total||0}}Xe(v)}}}catch(s){console.error("Error fetching devices:",s)}finally{re(!1)}},[]);o.useEffect(()=>{ze()},[ze]),o.useEffect(()=>{console.log("Component mounted, forcing fetchDevices"),F()},[F]),o.useEffect(()=>{const s=setInterval(()=>{console.log("Auto-refreshing devices for uptime update..."),F()},3e4);return()=>clearInterval(s)},[F]);const Ge=async()=>{if(!(!d?.id||d.id==="all")){Se(!0);try{console.log("Starting ping all devices...");const s=ye.length||0,l=Math.ceil(s/50),n=l*3+30,b=Math.max(6e5,n*1e3);console.log(`Ping timeout calculated: ${b/1e3}s for ${s} devices (${l} batches)`);const v=await fetch("/ping-all-devices",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:AbortSignal.timeout(b)});if(console.log("Ping all response status:",v.status),v.ok){const a=await v.json();if(console.log("Ping all response data:",a),a.stats?.status==="processing"){const r=Math.ceil((a.stats.estimated_duration_seconds||60)/60);alert(`âœ… ${a.message}

${a.note}

ðŸ’¡ Estimated completion: ${r} minute(s). Refresh the page after completion to see updated device statuses.`);const c=(a.stats.estimated_duration_seconds||60)*1e3;setTimeout(()=>{F()},c)}else{await F();const r=a.stats?.total_devices||0,c=a.stats?.online_devices||0,w=a.stats?.offline_devices||0,_=r>0?(c/r*100).toFixed(1):0,S=a.stats?.devices_per_second||0,q=a.stats?.error_count||0;let j=`âœ… All Devices Pinged Successfully!

Total Devices: ${r}
Online: ${c}
Offline: ${w}
Uptime: ${_}%
Duration: ${(a.stats?.ping_duration/1e3||0).toFixed(1)}s
Speed: ${S} devices/sec`;q>0&&(j+=`
Errors: ${q} (devices marked offline)`),j+=`

All devices including offline ones have been pinged.`,alert(j)}}else{const a=await v.text();console.error("Ping all error response:",a);let r="Failed to ping all devices";try{const c=JSON.parse(a);r=c.message||c.error||r}catch{r=a||r}v.status===500&&r.includes("Maximum execution time")&&(r="Ping operation took too long. Try with fewer devices or check server timeout settings."),alert(`âŒ ${r}`)}}catch(s){if(console.error("Error pinging all devices:",s),s instanceof Error&&s.name==="AbortError")alert("âŒ Ping operation timed out. The operation may still be running on the server. Please wait a few minutes and refresh the page to see updated results.");else{const l=s instanceof Error?s.message:"Unknown error occurred";alert(`âŒ Network error while pinging all devices: ${l}`)}}finally{Se(!1)}}},es=async s=>{Ce(s);try{const l=await fetch(`/ping-device/${s}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(l.ok){const n=await l.json();le(a=>a.map(r=>r.id===s?{...r,status:n.device.status,response_time:n.device.response_time,last_ping:n.device.last_ping}:r)),t&&t.id===s&&D({...t,status:n.device.status,response_time:n.device.response_time,last_ping:n.device.last_ping});const b=n.device.status==="online"?"ðŸŸ¢":"ðŸ”´",v=n.debug?`

DEBUG INFO:
Ping Command: ${n.debug.ping_command}
Return Code: ${n.debug.return_code}
DB Status: ${n.debug.database_status_after_update}
DB Response Time: ${n.debug.database_response_time_after_update}ms`:"";alert(`${b} ${n.device.name}

Status: ${n.device.status}
Response Time: ${n.device.response_time||"N/A"}ms
Last Ping: ${n.device.last_ping}${v}

Note: Using real ICMP ping`)}else{const n=await l.json();alert(`âŒ Failed to get device status: ${n.error||"Unknown error"}`)}}catch(l){console.error("Error getting device status:",l),alert("âŒ Network error while getting device status")}finally{Ce(null)}};o.useEffect(()=>{ne(1)},[p,$,h,x,g,N,y,C,z]),o.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]);const ss=ye,oe=ve.length>0?ve:[],ce=we.length>0?we:[],Ae=g!=="all"?te.filter(s=>s.brand_id===parseInt(g)):te,E=s=>{C===s?Ne(z==="asc"?"desc":"asc"):(Be(s),Ne("asc"))},M=ss,ts=()=>{k(""),J("all"),I("all"),O("all"),R("all"),se("all"),f("all")},De=[h,$!=="all",x!=="all",g!=="all",N!=="all",y!=="all",p!=="all"].filter(Boolean).length;return o.useEffect(()=>{if(d?.id){const s=d?.id==="all"?"/api/locations":`/api/locations?branch_id=${d.id}`;fetch(s,{credentials:"same-origin",headers:{Accept:"application/json"}}).then(l=>l.ok?l.json():[]).then(l=>Ve(l)).catch(l=>console.error("Error loading locations:",l)),fetch("/api/brands",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(l=>l.ok?l.json():[]).then(l=>We(l)).catch(l=>console.error("Error loading brands:",l)),fetch("/api/models",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(l=>l.ok?l.json():[]).then(l=>qe(l)).catch(l=>console.error("Error loading models:",l)),fetch("/api/users",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(l=>l.ok?l.json():[]).then(l=>He(l)).catch(l=>console.error("Error loading users:",l))}},[d?.id]),e.jsx(ns,{title:i("devices.title"),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-xl border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:border-blue-900/30 dark:from-blue-950/20 dark:to-indigo-950/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 p-2 shadow-lg",children:e.jsx(ge,{className:"size-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:d?.name||"No Branch Selected"}),e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[d?.description||"Please select a branch"," â€¢ ",d?.deviceCount||0," devices"]})]})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-3xl font-bold text-transparent dark:from-white dark:to-slate-300",children:i("devices.title")}),e.jsx("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-400",children:i("devices.subtitle")})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(cs,{className:"absolute left-3 top-1/2 size-5 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:i("devices.search"),value:h,onChange:s=>k(s.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pl-10 pr-4 text-sm text-slate-900 placeholder-slate-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white dark:placeholder-slate-500"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:Ge,disabled:ie||Ke||!d?.id||d?.id==="all",className:"flex items-center gap-2 rounded-lg bg-gradient-to-r from-green-500 to-emerald-600 px-4 py-2 text-sm font-medium text-white shadow-lg transition-all hover:from-green-600 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Ping all devices in current branch",children:[e.jsx(Le,{className:`size-4 ${ie?"animate-spin":""}`}),e.jsx("span",{children:ie?"Pinging...":"Ping All"})]}),G&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-blue-50 px-3 py-2 text-sm text-blue-700 dark:bg-blue-900/20 dark:text-blue-300",children:[e.jsx(xs,{className:"size-4"}),e.jsxs("span",{children:["Last: ",G.online,"/",G.total," online"]}),e.jsxs("span",{className:"text-xs",children:["(",G.duration,"ms)"]})]}),e.jsxs("div",{className:"flex gap-1 rounded-lg border border-slate-200 bg-white p-1 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("button",{onClick:()=>ke("grid"),className:`rounded-md p-2 transition-all ${Q==="grid"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-700"}`,title:"Grid View",children:e.jsx(js,{className:"size-4"})}),e.jsx("button",{onClick:()=>ke("list"),className:`rounded-md p-2 transition-all ${Q==="list"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-700"}`,title:"List View",children:e.jsx(Ns,{className:"size-4"})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["all","online","warning","offline","offline_ack"].map(s=>e.jsx("button",{onClick:()=>J(s),className:`rounded-lg px-3 py-2 text-sm font-medium transition-all ${$===s?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700"}`,children:s==="all"?i("devices.all"):s==="offline_ack"?"Acknowledged":s.charAt(0).toUpperCase()+s.slice(1)},s)),e.jsxs("button",{onClick:()=>Te(!Z),className:`flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all ${Z||g!=="all"||N!=="all"||x!=="all"||y!=="all"?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700"}`,children:["Advanced Filters",Z?e.jsx(L,{className:"size-4"}):e.jsx(A,{className:"size-4"})]}),De>0&&e.jsxs("button",{onClick:ts,className:"flex items-center gap-2 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm font-medium text-red-700 hover:bg-red-100 dark:border-red-900/30 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30",children:[e.jsx(U,{className:"size-4"}),"Clear All (",De,")"]})]}),Z&&e.jsxs("div",{className:"rounded-xl border border-slate-200/50 bg-gradient-to-br from-white to-slate-50 p-4 shadow-inner dark:border-slate-700/50 dark:from-slate-800 dark:to-slate-900",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Location"}),e.jsxs("select",{value:x,onChange:s=>I(s.target.value),className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsxs("option",{value:"all",children:["All Locations (",oe.length,")"]}),oe.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:["Filtered by ",d?.name||"current branch"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Brand"}),e.jsxs("select",{value:g,onChange:s=>{O(s.target.value),s.target.value==="all"&&R("all")},className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsxs("option",{value:"all",children:["All Brands (",ce.length,")"]}),ce.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"From database"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Model"}),e.jsxs("select",{value:N,onChange:s=>R(s.target.value),disabled:g==="all",className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsx("option",{value:"all",children:g==="all"?"Select brand first":`All Models (${Ae.length})`}),Ae.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:g==="all"?"Dependent on brand":"From database"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Managed By"}),e.jsxs("select",{value:y,onChange:s=>se(s.target.value),className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsxs("option",{value:"all",children:["All Users (",ae.length,")"]}),e.jsx("option",{value:"unassigned",children:"Unassigned"}),ae.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.role,")"]},s.id))]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Filter by device manager"})]})]}),(g!=="all"||N!=="all"||x!=="all"||y!=="all")&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 border-t border-slate-200 pt-4 dark:border-slate-700",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Active:"}),x!=="all"&&e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",children:["Location: ",oe.find(s=>String(s.id)===x||s.name===x)?.name||x,e.jsx("button",{onClick:()=>I("all"),className:"hover:text-blue-900 dark:hover:text-blue-100",children:e.jsx(U,{className:"size-3"})})]}),g!=="all"&&e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-purple-100 px-2 py-1 text-xs font-medium text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",children:["Brand: ",ce.find(s=>String(s.id)===g)?.name||g,e.jsx("button",{onClick:()=>{O("all"),R("all")},className:"hover:text-purple-900 dark:hover:text-purple-100",children:e.jsx(U,{className:"size-3"})})]}),N!=="all"&&e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-pink-100 px-2 py-1 text-xs font-medium text-pink-700 dark:bg-pink-900/30 dark:text-pink-300",children:["Model: ",te.find(s=>String(s.id)===N)?.name||N,e.jsx("button",{onClick:()=>R("all"),className:"hover:text-pink-900 dark:hover:text-pink-100",children:e.jsx(U,{className:"size-3"})})]}),y!=="all"&&e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-700 dark:bg-green-900/30 dark:text-green-300",children:["Managed By: ",y==="unassigned"?"Unassigned":ae.find(s=>String(s.id)===y)?.name||y,e.jsx("button",{onClick:()=>se("all"),className:"hover:text-green-900 dark:hover:text-green-100",children:e.jsx(U,{className:"size-3"})})]})]}),e.jsx("div",{className:"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-900/30 dark:bg-blue-950/20",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ms,{className:"size-4 text-blue-600 dark:text-blue-400 mt-0.5 shrink-0"}),e.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-300",children:[e.jsx("p",{className:"font-semibold",children:"Advanced Filters"}),e.jsxs("p",{className:"mt-1",children:["â€¢ Location: ",d?.id==="all"?e.jsx(e.Fragment,{children:"Shows locations from all branches"}):e.jsxs(e.Fragment,{children:["Shows locations within ",e.jsx("strong",{children:d?.name||"current branch"})," only"]})]}),e.jsx("p",{children:"â€¢ Brand & Model: Loaded from database configuration"}),e.jsx("p",{children:"â€¢ Select brand to filter available models"})]})]})})]})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:Ye.map(s=>{const l=s.icon,n=p===s.id;return e.jsxs("button",{onClick:()=>f(s.id),className:`group flex flex-col items-center gap-3 rounded-xl border p-4 transition-all hover:scale-105 ${n?"border-blue-500 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-lg dark:border-blue-400 dark:from-blue-950/30 dark:to-indigo-950/30":"border-slate-200 bg-white hover:border-slate-300 hover:shadow-md dark:border-slate-700 dark:bg-slate-800 dark:hover:border-slate-600"}`,title:s.description,children:[e.jsx("div",{className:`rounded-full p-3 transition-all ${n?"bg-gradient-to-br from-blue-500 to-indigo-600 shadow-lg":"bg-slate-100 group-hover:bg-slate-200 dark:bg-slate-700 dark:group-hover:bg-slate-600"}`,children:e.jsx(l,{className:`size-6 ${n?"text-white":"text-slate-600 dark:text-slate-400"}`})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`text-sm font-bold ${n?"text-blue-900 dark:text-blue-100":"text-slate-900 dark:text-white"}`,children:s.name}),s.description&&e.jsx("p",{className:`mt-1 text-xs line-clamp-2 ${n?"text-blue-700 dark:text-blue-300":"text-slate-500 dark:text-slate-400"}`,children:s.description}),e.jsxs("p",{className:`mt-1 text-xs font-semibold ${n?"text-blue-600 dark:text-blue-400":"text-slate-500 dark:text-slate-400"}`,children:[s.count," ",i("common.devices")]})]})]},s.id)})}),M.length===0&&e.jsxs("div",{className:"rounded-2xl border border-slate-200/50 bg-white p-12 text-center shadow-lg dark:border-slate-700/50 dark:bg-slate-800",children:[e.jsx(Ee,{className:"mx-auto mb-4 size-12 text-slate-400"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:i("devices.noDevices")}),e.jsx("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-400",children:i(h||$!=="all"||p!=="all"||x!=="all"||g!=="all"||N!=="all"||y!=="all"?"devices.tryAdjustingFilters":"devices.noDevicesConfigured")})]}),Q==="grid"&&M.length>0&&(()=>{const s=new Map;M.forEach(a=>{const r=a.location_name||(typeof a.location=="string"?a.location:null)||a.location?.name||"Unknown Location",c=a.location_id||null,w=a.location?.location_folder?.id||a.location_folder_id||null,_=a.location?.location_folder?.name||a.location_folder_name||"Ungrouped",S=`${c??r}`;s.has(S)||s.set(S,{locationName:r,locationId:c,folderId:w,folderName:_,devices:[]}),s.get(S).devices.push(a)});const l=new Map;s.forEach(a=>{const r=a.folderName||"Ungrouped",c=a.folderId??null,w=`${c??r}`;l.has(w)||l.set(w,{folderName:r,folderId:c,locations:[]}),l.get(w).locations.push(a)});const n=[];l.forEach(a=>{a.locations.sort((r,c)=>r.locationName.localeCompare(c.locationName)),n.push(a)}),n.sort((a,r)=>a.folderName==="Ungrouped"?1:r.folderName==="Ungrouped"?-1:a.folderName.localeCompare(r.folderName));const b=(a,r)=>{const c=`${a}:${r}`;Re(w=>{const _=new Set(w);return _.has(c)?_.delete(c):(w.forEach(S=>{S.startsWith(`${a}:`)&&_.delete(S)}),_.add(c)),_})},v=(a,r)=>Oe.has(`${a}:${r}`);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-3 text-xs bg-slate-50 dark:bg-slate-800/50 rounded-lg p-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:m.tiny,onChange:a=>W(r=>({...r,tiny:a.target.checked}))}),"Smallest"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:m.dense,onChange:a=>W(r=>({...r,dense:a.target.checked}))}),"Dense"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:m.showName,onChange:a=>W(r=>({...r,showName:a.target.checked}))}),"Name"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:m.showIp,onChange:a=>W(r=>({...r,showIp:a.target.checked}))}),"IP"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:m.showStatus,onChange:a=>W(r=>({...r,showStatus:a.target.checked}))}),"Status"]})]}),n.map(a=>{const r=a.locations.reduce((c,w)=>c+w.devices.length,0);return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-emerald-600 text-white rounded-lg px-6 py-4 shadow-lg",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"size-6"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:a.folderName}),e.jsxs("p",{className:"text-sm opacity-90",children:[a.locations.length," location",a.locations.length!==1?"s":""," â€¢ ",r," device",r!==1?"s":""]})]})]})})}),e.jsx("div",{className:"space-y-1 ml-4",children:a.locations.map(c=>{const w=`${a.folderName}:${c.locationName}`,_=v(a.folderName,c.locationName),S=c.devices.filter(j=>j.status==="online").length,q=c.devices.filter(j=>j.status==="offline").length;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsx("button",{onClick:()=>b(a.folderName,c.locationName),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 text-left",children:[_?e.jsx(A,{className:"size-5 text-slate-600 dark:text-slate-400"}):e.jsx(Pe,{className:"size-5 text-slate-600 dark:text-slate-400"}),e.jsx(xe,{className:"size-5 text-slate-600 dark:text-slate-400"}),e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:c.locationName}),e.jsxs("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:["(",c.devices.length," device",c.devices.length!==1?"s":"",")"]}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[S>0&&e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300",children:[S," online"]}),q>0&&e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300",children:[q," offline"]})]})]})}),_&&e.jsx("div",{className:"border-t border-slate-200 dark:border-slate-700 p-4",children:e.jsx("div",{className:`grid ${m.tiny?"grid-cols-6 sm:grid-cols-8 md:grid-cols-12 lg:grid-cols-16 xl:grid-cols-20 2xl:grid-cols-24 gap-1":m.dense?"grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 xl:grid-cols-12 2xl:grid-cols-14 gap-1.5":"grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-10 gap-3"}`,children:c.devices.map(j=>e.jsx("div",{className:`group cursor-pointer ${m.tiny?"rounded sm:rounded":"rounded-md"} border border-transparent bg-white ${m.tiny?"shadow-none":"shadow"} ${m.tiny?"":"hover:shadow-lg"} transition-all ${m.tiny?"":"hover:scale-105"} dark:bg-slate-800 ${m.tiny?"p-0.5":m.dense?"p-1.5":"p-2.5"} overflow-hidden`,onClick:()=>{D(j),je(j.id)},children:e.jsxs("div",{className:"flex flex-col items-center text-center w-full min-w-0",children:[e.jsx("div",{className:`${m.tiny?"mb-0":"mb-0.5"} ${m.tiny?"rounded":"rounded-md"} border border-transparent ${m.tiny?"p-0.5":m.dense?"p-1":"p-1.5"} transition-transform ${m.tiny?"":"group-hover:scale-110"} ${T(j.status)} flex-shrink-0`,children:(()=>{const as=ee(j.category||"");return e.jsx(as,{className:`${m.tiny||m.dense?"size-3":"size-4"} ${B(j.status)}`})})()}),m.showName&&e.jsx("h3",{className:`${m.tiny?"mt-0.5 text-[9px]":"mb-0 text-[10px]"} font-medium text-slate-900 dark:text-slate-200 line-clamp-1 w-full min-w-0 px-0.5 overflow-hidden text-ellipsis`,children:j.name}),!m.tiny&&m.showIp&&e.jsx("div",{className:"mt-0.5 text-[10px] text-slate-500 dark:text-slate-400 line-clamp-1 w-full min-w-0 px-0.5 overflow-hidden text-ellipsis",children:j.ip_address}),!m.tiny&&m.showStatus&&e.jsx("div",{className:"mt-0.5 text-[10px] w-full min-w-0 px-0.5",children:e.jsx("span",{className:`rounded px-1.5 py-0.5 ${T(j.status)} ${B(j.status)} inline-block line-clamp-1 overflow-hidden text-ellipsis`,children:ue(j.status)})})]})},j.id))})})]},w)})})]},`${a.folderId??a.folderName}`)}),n.length===0&&e.jsx("div",{className:"text-center py-12 text-slate-500 dark:text-slate-400",children:"No devices found for the selected filters."}),e.jsx(Fe,{currentPage:X,totalPages:$e,totalItems:V,perPage:Y,onPageChange:ne,onPerPageChange:_e})]})})(),Q==="list"&&M.length>0&&e.jsxs("div",{className:"rounded-2xl border border-slate-200/50 bg-white shadow-lg dark:border-slate-700/50 dark:bg-slate-800 overflow-hidden",children:[e.jsx("div",{className:"border-b border-slate-200/50 bg-gradient-to-r from-slate-50 to-slate-100 p-6 dark:border-slate-700/50 dark:from-slate-900/50 dark:to-slate-800/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[p!=="all"&&(()=>{const s=ee(p);return e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 p-3 shadow-lg",children:e.jsx(s,{className:"size-6 text-white"})})})(),p==="all"&&e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 p-3 shadow-lg",children:e.jsx(be,{className:"size-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:he.find(s=>s.id===p)?.name||"All Devices"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Showing ",M.length," device",M.length!==1?"s":""," on this page",V>0&&e.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(Total: ",V," device",V!==1?"s":""," matching filters across all pages)"]})]})]})]})}),e.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:e.jsxs("table",{className:"w-full min-w-[800px] sm:min-w-0",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>E("name"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Name",C==="name"?z==="asc"?e.jsx(L,{className:"size-4"}):e.jsx(A,{className:"size-4"}):e.jsx(P,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>E("ip_address"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["IP Address",C==="ip_address"?z==="asc"?e.jsx(L,{className:"size-4"}):e.jsx(A,{className:"size-4"}):e.jsx(P,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>E("uptime_percentage"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Uptime",C==="uptime_percentage"?z==="asc"?e.jsx(L,{className:"size-4"}):e.jsx(A,{className:"size-4"}):e.jsx(P,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>E("status"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Status",C==="status"?z==="asc"?e.jsx(L,{className:"size-4"}):e.jsx(A,{className:"size-4"}):e.jsx(P,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left",children:e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Last Ping"})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>E("location"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Location",C==="location"?z==="asc"?e.jsx(L,{className:"size-4"}):e.jsx(A,{className:"size-4"}):e.jsx(P,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>E("brand"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Brand/Model",C==="brand"?z==="asc"?e.jsx(L,{className:"size-4"}):e.jsx(A,{className:"size-4"}):e.jsx(P,{className:"size-4 opacity-30"})]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200/50 dark:divide-slate-700/50",children:M.map(s=>e.jsxs("tr",{className:"cursor-pointer transition-colors hover:bg-slate-50 dark:hover:bg-slate-700/50",onClick:()=>{D(s),je(s.id)},children:[e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`rounded-lg border p-2 ${T(s.status)}`,children:(()=>{const l=ee(s.category||"");return e.jsx(l,{className:`size-4 ${B(s.status)}`})})()}),e.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-white",children:s.name})]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400 font-mono",children:s.ip_address})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400",children:[e.jsx(me,{className:"size-4"}),pe(s.uptime_minutes)]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-medium ${T(s.status)} ${B(s.status)}`,children:[Ie(s.status),ue(s.status)]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:s.last_ping?new Date(s.last_ping).toLocaleString():"Never"})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:s.latitude&&s.longitude?e.jsxs("button",{onClick:l=>{l.stopPropagation();const n=new URLSearchParams;s.location_id&&n.set("location_id",String(s.location_id)),n.set("deviceId",String(s.id)),Me.visit(`/monitor/plan?${n.toString()}`)},className:"flex items-center gap-1.5 rounded-lg bg-blue-100 px-2 py-1 text-blue-700 transition-all hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50",title:"Open floor plan",children:[e.jsx(xe,{className:"size-3.5"}),e.jsx("span",{className:"text-xs font-medium",children:s.location})]}):e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:s.location})}),e.jsx("td",{className:"px-3 sm:px-6 py-4",children:s.brand&&s.model?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:s.brand}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:s.model})]}):e.jsx("span",{className:"text-slate-400 dark:text-slate-600",children:"-"})})]},s.id))})]})}),e.jsx(Fe,{currentPage:X,totalPages:$e,totalItems:V,perPage:Y,onPageChange:ne,onPerPageChange:_e})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/90 backdrop-blur-md",onClick:()=>D(null)}),e.jsxs("div",{className:"fixed left-1/2 top-1/2 z-50 w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 overflow-hidden rounded-2xl border border-slate-200/50 bg-white shadow-2xl dark:border-slate-700/50 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200/50 p-6 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`rounded-xl border p-3 ${T(t.status)}`,children:(()=>{const s=ee(t.category||"");return e.jsx(s,{className:`size-6 ${B(t.status)}`})})()}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:t.ip_address})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:s=>{s.stopPropagation(),es(t.id)},disabled:de===t.id,className:"flex items-center gap-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-lg transition-all hover:from-blue-600 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Ping this device",children:[e.jsx(Le,{className:`size-4 ${de===t.id?"animate-spin":""}`}),e.jsx("span",{children:de===t.id?"Pinging...":"Ping Device"})]}),e.jsx("button",{onClick:()=>D(null),className:"rounded-lg p-2 text-slate-500 transition-all hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800",children:e.jsx(U,{className:"size-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Status"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`flex items-center gap-2 rounded-full px-3 py-1 text-sm font-medium ${T(t.status)} ${B(t.status)}`,children:[Ie(t.status),ue(t.status)]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Uptime"}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[e.jsx(me,{className:"size-4"}),e.jsx("span",{className:"text-lg font-semibold",children:pe(t.uptime_minutes)})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Response Time"}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[e.jsx(ws,{className:"size-4"}),e.jsx("span",{className:"text-lg font-semibold",children:t.response_time?`${t.response_time}ms`:"N/A"}),t.response_time&&t.response_time>100&&e.jsx("span",{className:"rounded-full bg-yellow-100 px-2 py-0.5 text-xs font-medium text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",children:"High"})]})]}),t.status==="offline"&&e.jsx(e.Fragment,{children:t.offline_duration_minutes!==void 0&&t.offline_duration_minutes>0&&e.jsxs("div",{className:"rounded-xl bg-orange-50 p-4 dark:bg-orange-950/20",children:[e.jsx("h3",{className:"mb-2 text-sm font-semibold text-orange-900 dark:text-orange-300",children:"Offline Duration"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"size-4 text-orange-600 dark:text-orange-400"}),e.jsx("span",{className:"text-lg font-semibold text-orange-700 dark:text-orange-400",children:ys(t.offline_duration_minutes)}),t.offline_duration_minutes!==void 0&&t.offline_duration_minutes>=10&&e.jsx("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-medium text-red-700 dark:bg-red-900/30 dark:text-red-400",children:"Alert Triggered"})]}),t.offline_since&&e.jsxs("p",{className:"mt-2 text-xs text-orange-600 dark:text-orange-400",children:["Offline since: ",new Date(t.offline_since).toLocaleString()]})]})}),t.status==="offline"&&e.jsx("div",{className:"rounded-xl bg-red-50 p-4 dark:bg-red-950/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"size-5 text-red-600 dark:text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-700 dark:text-red-400",children:"Device Offline"}),e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:"This device is currently offline and not responding to monitoring requests."})]})]})}),t.status==="offline_ack"&&t.offline_reason&&e.jsx("div",{className:"rounded-xl bg-blue-50 p-4 dark:bg-blue-950/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ue,{className:"size-5 text-blue-600 dark:text-blue-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-blue-700 dark:text-blue-400",children:"Offline - Acknowledged"}),e.jsxs("div",{className:"mt-3 rounded-lg border border-blue-200 bg-white p-3 dark:border-blue-900/30 dark:bg-blue-950/30",children:[e.jsx("p",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300",children:"Reason:"}),e.jsx("p",{className:"mt-1 text-sm text-blue-900 dark:text-blue-200",children:t.offline_reason}),t.offline_acknowledged_by&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-blue-600 dark:text-blue-400",children:[e.jsx(ps,{className:"size-3"}),e.jsxs("span",{children:["Acknowledged by ",t.offline_acknowledged_by]}),t.offline_acknowledged_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:new Date(t.offline_acknowledged_at).toLocaleString()})]})]})]})]})]})}),t.status==="warning"&&e.jsx("div",{className:"rounded-xl bg-yellow-50 p-4 dark:bg-yellow-950/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"size-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-yellow-700 dark:text-yellow-400",children:"Device Warning"}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx("div",{className:"rounded-lg border border-yellow-200 bg-white p-3 dark:border-yellow-900/30 dark:bg-yellow-950/30",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-yellow-700 dark:text-yellow-300",children:"Response Time:"}),e.jsxs("span",{className:"font-bold text-yellow-900 dark:text-yellow-200",children:[t.response_time?`${t.response_time}ms`:"N/A",t.response_time&&t.response_time>100&&e.jsx("span",{className:"ml-2 text-xs",children:"(High)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-yellow-700 dark:text-yellow-300",children:"Uptime:"}),e.jsx("span",{className:"font-bold text-yellow-900 dark:text-yellow-200",children:pe(t.uptime_minutes)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-yellow-700 dark:text-yellow-300",children:"Last Check:"}),e.jsx("span",{className:"font-medium text-yellow-900 dark:text-yellow-200",children:t.last_check?new Date(t.last_check).toLocaleString():"Never"})]})]})}),e.jsxs("div",{className:"rounded-lg bg-yellow-100 p-3 dark:bg-yellow-900/20",children:[e.jsx("p",{className:"text-xs font-semibold text-yellow-800 dark:text-yellow-300",children:"Possible Issues:"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-700 dark:text-yellow-400",children:[t.response_time&&t.response_time>100&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 size-1 rounded-full bg-yellow-600 dark:bg-yellow-400"}),e.jsx("span",{children:"High response time detected - Network congestion or device overload"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 size-1 rounded-full bg-yellow-600 dark:bg-yellow-400"}),e.jsx("span",{children:"Device requires attention - Monitor closely for potential failures"})]})]})]}),e.jsxs("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:[e.jsx("p",{className:"font-medium",children:"Recommended Action:"}),e.jsx("p",{className:"mt-1",children:"Schedule maintenance check or investigate network connectivity to prevent potential downtime."})]})]})]})]})}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-4 dark:bg-slate-800",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Device Information"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Category:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:he.find(s=>s.id===t.category)?.name})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"IP Address:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white font-mono",children:t.ip_address})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"MAC Address:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white font-mono",children:t.mac_address})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Barcode:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"size-4 text-slate-500 dark:text-slate-400"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white font-mono",children:t.barcode})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Serial Number:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white font-mono",children:t.serial_number||"-"})]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Managed By:"}),e.jsx("div",{className:"text-right",children:t.managed_by_user?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:t.managed_by_user.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:t.managed_by_user.email}),e.jsx("span",{className:`mt-1 inline-flex rounded-full px-2 py-0.5 text-xs font-medium ${t.managed_by_user.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}`,children:t.managed_by_user.role}),Array.isArray(t.managed_by_users)&&t.managed_by_users.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:t.managed_by_users.map(s=>e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s.email}),e.jsx("span",{className:`mt-1 inline-flex rounded-full px-2 py-0.5 text-xs font-medium ${s.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}`,children:s.role})]},s.id))})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-slate-400 dark:text-slate-600",children:"Not assigned"}),Array.isArray(t.managed_by_users)&&t.managed_by_users.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:t.managed_by_users.map(s=>e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s.email}),e.jsx("span",{className:`mt-1 inline-flex rounded-full px-2 py-0.5 text-xs font-medium ${s.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}`,children:s.role})]},s.id))})]})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Response Time:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:t.response_time?`${t.response_time}ms`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Last Ping:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:t.last_ping?new Date(t.last_ping).toLocaleString():"Never"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Last Changed:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:t.updated_at?new Date(t.updated_at).toLocaleString():"Never"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Location:"}),e.jsxs("button",{onClick:()=>{D(null),Me.visit("/monitor/maps",{data:{deviceId:t.id,lat:t.latitude,lng:t.longitude}})},className:"flex items-center gap-1.5 rounded-lg bg-blue-100 px-3 py-1.5 text-blue-700 transition-all hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50",children:[e.jsx(xe,{className:"size-3.5"}),e.jsx("span",{className:"font-medium",children:t.location})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Brand/Model:"}),t.brand&&t.model?e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:t.brand}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:t.model})]}):e.jsx("span",{className:"text-slate-400 dark:text-slate-600",children:"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Device ID:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:t.id})]})]})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-4 dark:bg-slate-800",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Comments"}),e.jsx(_s,{deviceId:t.id})]})]})})]})]})]})})}function _s({deviceId:i}){const[u,d]=o.useState([]),[p,f]=o.useState(!1),h=o.useCallback(async()=>{f(!0);try{const k=await fetch(`/devices/${i}/comments`);if(k.ok){const $=await k.json();d($.comments)}}catch(k){console.error("Error fetching comments:",k)}finally{f(!1)}},[i]);return o.useEffect(()=>{h()},[h]),p?e.jsx("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading comments..."}):u.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No comments yet for this device."}):e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:u.map(k=>e.jsxs("div",{className:"rounded-lg bg-slate-50 p-4 border border-slate-200 dark:bg-slate-700 dark:border-slate-600",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${k.type==="maintenance"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400":k.type==="issue"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":k.type==="note"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"}`,children:k.type}),e.jsx("span",{className:"font-medium text-sm text-slate-900 dark:text-white",children:k.author})]}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:new Date(k.created_at).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap",children:k.comment})]},k.id))})}function Fe({currentPage:i,totalPages:u,totalItems:d,perPage:p,onPageChange:f,onPerPageChange:h}){const k=(i-1)*p+1,$=Math.min(i*p,d),J=()=>{const x=[];if(u<=5)for(let g=1;g<=u;g++)x.push(g);else{x.push(1),i>3&&x.push("...");const g=Math.max(2,i-1),O=Math.min(u-1,i+1);for(let N=g;N<=O;N++)x.push(N);i<u-2&&x.push("..."),x.push(u)}return x};return u<=1?null:e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 bg-white px-4 py-3 dark:border-slate-700 dark:bg-slate-800 sm:px-6",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>f(i-1),disabled:i===1,className:"relative inline-flex items-center rounded-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200",children:"Previous"}),e.jsx("button",{onClick:()=>f(i+1),disabled:i===u,className:"relative ml-3 inline-flex items-center rounded-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:["Showing ",e.jsx("span",{className:"font-medium",children:k})," to ",e.jsx("span",{className:"font-medium",children:$})," of"," ",e.jsx("span",{className:"font-medium",children:d})," results"]}),e.jsxs("select",{value:p,onChange:x=>h(Number(x.target.value)),className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200",children:[e.jsx("option",{value:300,children:"300 per page"}),e.jsx("option",{value:500,children:"500 per page"}),e.jsx("option",{value:800,children:"800 per page"}),e.jsx("option",{value:1e3,children:"1000 per page"})]})]}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>f(i-1),disabled:i===1,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-slate-400 ring-1 ring-inset ring-slate-300 hover:bg-slate-50 disabled:opacity-50 dark:ring-slate-600 dark:hover:bg-slate-700",children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx(is,{className:"size-5"})]}),J().map((x,I)=>x==="..."?e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-slate-700 ring-1 ring-inset ring-slate-300 dark:text-slate-300 dark:ring-slate-600",children:"..."},`ellipsis-${I}`):e.jsx("button",{onClick:()=>f(x),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ring-1 ring-inset ring-slate-300 dark:ring-slate-600 ${i===x?"z-10 bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-slate-900 hover:bg-slate-50 dark:text-slate-100 dark:hover:bg-slate-700"}`,children:x},x)),e.jsxs("button",{onClick:()=>f(i+1),disabled:i===u,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-slate-400 ring-1 ring-inset ring-slate-300 hover:bg-slate-50 disabled:opacity-50 dark:ring-slate-600 dark:hover:bg-slate-700",children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx(Pe,{className:"size-5"})]})]})})]})]})}export{qs as default};
