import{a as es,b as ss,r,j as e,c as Ce}from"./app-DsbjyKGf.js";import{b as Le,M as ts,C,a as ze,c as as}from"./monitor-layout-Dq_xIMSU.js";import{C as ls,g as R}from"./device-icons-Bh4xq8HI.js";import{N as X,S as Fe,C as Ie}from"./server-Ca-qE3nK.js";import{W as rs}from"./wifi-Ccv0dO_b.js";import{S as is}from"./search-Ifj-fhqc.js";import{R as Ae}from"./refresh-cw-B7HEQ0fV.js";import{A as ns}from"./activity-BRPubSy7.js";import{c as T}from"./createLucideIcon-BnSOlFpd.js";import{C as z,U as ds}from"./user-CFCXsjPH.js";import{X as F,C as os}from"./x-8qECKafY.js";import{T as ce}from"./trending-up-DAIWa4gS.js";import{C as W}from"./circle-alert-YS0L10Ow.js";import{W as cs}from"./wifi-off-Df6rDOKK.js";import"./app-DiM3Qhuw.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],I=T("ArrowUpDown",xs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]],ps=T("Barcode",ms);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],gs=T("Grid3x3",hs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],bs=T("Info",us);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],js=T("List",fs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Ns=T("Zap",ks),xe=i=>{if(i===0)return"0m";const f=i,d=Math.floor(f/60),c=Math.floor(d/24),k=Math.floor(c/7);if(k>0){const h=c%7;return h>0?`${k}w ${h}d`:`${k}w`}else if(c>0){const h=d%24;return h>0?`${c}d ${h}h`:`${c}d`}else if(d>0){const h=f%60;return h>0?`${d}h ${h}m`:`${d}h`}else return`${f}m`},V=[{id:"all",name:"All Devices",icon:X,count:0},{id:"switches",name:"Switch",icon:X,count:0,description:"Peralatan nadi utama rangkaian UTHM"},{id:"servers",name:"Server",icon:Fe,count:0,description:"Sistem aplikasi dan Web untuk kegunaan pengguna UTHM"},{id:"wifi",name:"WiFi",icon:rs,count:0,description:"Kemudahan wifi yang disediakan untuk seluruh kawasan UTHM"},{id:"tas",name:"TAS",icon:Le,count:0,description:"Peralatan sistem kehadiran UTHM"},{id:"cctv",name:"CCTV",icon:ls,count:0,description:"Pemantauan CCTV"}],P=i=>{switch(i){case"online":return"text-green-600 dark:text-green-400";case"offline":return"text-red-600 dark:text-red-400";case"offline_ack":return"text-blue-600 dark:text-blue-400";case"warning":return"text-yellow-600 dark:text-yellow-400";default:return"text-gray-600 dark:text-gray-400"}},U=i=>{switch(i){case"online":return"bg-green-100 dark:bg-green-900/20";case"offline":return"bg-red-100 dark:bg-red-900/20";case"offline_ack":return"bg-blue-100 dark:bg-blue-900/20";case"warning":return"bg-yellow-100 dark:bg-yellow-900/20";default:return"bg-gray-100 dark:bg-gray-900/20"}},De=i=>{switch(i){case"online":return e.jsx(Ie,{className:"size-4"});case"offline":return e.jsx(cs,{className:"size-4"});case"offline_ack":return e.jsx(W,{className:"size-4"});case"warning":return e.jsx(W,{className:"size-4"});default:return e.jsx(W,{className:"size-4"})}},me=i=>{switch(i){case"offline_ack":return"OFFLINE (ACK)";case"online":return"ONLINE";case"offline":return"OFFLINE";case"warning":return"WARNING";case"unknown":return"UNKNOWN";default:return"UNKNOWN"}};function Es(){console.log("Devices component rendering!");const{t:i}=es(),{props:f}=ss(),{currentBranch:d}=f;console.log("Current Branch in render:",d);const[c,k]=r.useState("all"),[h,b]=r.useState(""),[v,q]=r.useState("all"),[o,A]=r.useState("all"),[p,B]=r.useState("all"),[j,E]=r.useState("all"),[N,Y]=r.useState("all"),[t,$]=r.useState(null),[ws,pe]=r.useState(!1),he=r.useCallback(async s=>{try{pe(!0);const a=await fetch(`/api/devices/${s}`,{headers:{Accept:"application/json"},credentials:"same-origin"});if(a.ok){const l=await a.json();console.log("Loaded device details",l),$(n=>n&&n.id===s?l:n)}else console.warn("Failed to fetch device details",a.status)}catch(a){console.error("Failed to load device details",a)}finally{pe(!1)}},[]),[H,ge]=r.useState("list"),[w,Pe]=r.useState("name"),[y,ue]=r.useState("asc"),[G,Ue]=r.useState(!1),[be,Te]=r.useState([]),[fe,Be]=r.useState([]),[ee,Ee]=r.useState([]),[se,Oe]=r.useState([]),[je,te]=r.useState([]),[Re,ae]=r.useState(!1),[K,le]=r.useState(1),[J,ke]=r.useState(300),[S,Ve]=r.useState(0),[Ne,We]=r.useState(1),[qe,He]=r.useState({all:0,switches:0,servers:0,wifi:0,tas:0,cctv:0}),[re,ve]=r.useState(!1),[ie,we]=r.useState(null),[Q,ys]=r.useState(null),[x,O]=r.useState(()=>{try{const s=localStorage.getItem("deviceGridViewOptions");if(s)return JSON.parse(s)}catch{}return{showName:!1,showIp:!1,showStatus:!1,dense:!0,tiny:!1}});r.useEffect(()=>{try{localStorage.setItem("deviceGridViewOptions",JSON.stringify(x))}catch{}},[x]);const Ge=V.map(s=>({...s,count:qe[s.id]||0})),D=r.useCallback(async()=>{console.log("fetchDevices called"),ae(!0);try{const s=new URLSearchParams({page:K.toString(),per_page:J.toString()});d?.id&&(d.id==="all"?s.append("branch_id","all"):s.append("branch_id",d.id.toString())),c!=="all"&&s.append("category",c),v!=="all"&&s.append("status",v),h&&s.append("search",h),o!=="all"&&s.append("location",o),p!=="all"&&s.append("brand",p),j!=="all"&&s.append("model",j),N!=="all"&&s.append("managed_by",N),s.append("sort_by",w),s.append("sort_order",y);const a=`/api/devices?${s.toString()}`;console.log("Fetching devices from:",a);const l=await fetch(a,{credentials:"same-origin",headers:{Accept:"application/json"},cache:"no-cache"});if(console.log("API Response status:",l.status),l.ok){const n=await l.json();if(console.log("API Response data:",n),n.pagination)console.log("Setting devices from paginated response:",n.data?.length||0),n.data&&n.data.length>0&&n.data.slice(0,3).forEach(m=>{console.log(`Device ${m.name}: uptime_minutes = ${m.uptime_minutes} (type: ${typeof m.uptime_minutes})`)}),te(n.data||[]),Ve(n.pagination.total),We(n.pagination.last_page);else{const g=n.data||n;console.log("Setting devices from fallback response:",g.length),te(g)}}}catch(s){console.error("Error fetching devices:",s)}finally{ae(!1)}},[K,J,c,v,h,o,p,j,N,w,y,d?.id]),ye=r.useCallback(async()=>{try{let s="/api/devices?per_page=1";d?.id&&(d.id==="all"?s="/api/devices?branch_id=all&per_page=1":s=`/api/devices?branch_id=${d.id}&per_page=1`);const a=await fetch(s,{credentials:"same-origin",headers:{Accept:"application/json"}});if(a.ok){const l=await a.json();if(l.pagination){const g={all:l.pagination.total};for(const m of["switches","servers","wifi","tas","cctv"]){const u=await fetch(d?.id==="all"?`/api/devices?branch_id=all&category=${m}&per_page=1`:`/api/devices?branch_id=${d?.id}&category=${m}&per_page=1`,{credentials:"same-origin",headers:{Accept:"application/json"}});if(u.ok){const _=await u.json();g[m]=_.pagination?.total||0}}He(g)}}}catch(s){console.error("Error fetching devices:",s)}finally{ae(!1)}},[]);r.useEffect(()=>{ye()},[ye]),r.useEffect(()=>{console.log("Component mounted, forcing fetchDevices"),D()},[D]),r.useEffect(()=>{const s=setInterval(()=>{console.log("Auto-refreshing devices for uptime update..."),D()},3e4);return()=>clearInterval(s)},[D]);const Ke=async()=>{if(!(!d?.id||d.id==="all")){ve(!0);try{console.log("Starting ping all devices...");const s=je.length||0,a=Math.ceil(s/50),l=a*3+30,n=Math.max(6e5,l*1e3);console.log(`Ping timeout calculated: ${n/1e3}s for ${s} devices (${a} batches)`);const g=await fetch("/ping-all-devices",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:AbortSignal.timeout(n)});if(console.log("Ping all response status:",g.status),g.ok){const m=await g.json();if(console.log("Ping all response data:",m),m.stats?.status==="processing"){const u=Math.ceil((m.stats.estimated_duration_seconds||60)/60);alert(`âœ… ${m.message}

${m.note}

ðŸ’¡ Estimated completion: ${u} minute(s). Refresh the page after completion to see updated device statuses.`);const _=(m.stats.estimated_duration_seconds||60)*1e3;setTimeout(()=>{D()},_)}else{await D();const u=m.stats?.total_devices||0,_=m.stats?.online_devices||0,Ze=m.stats?.offline_devices||0,Xe=u>0?(_/u*100).toFixed(1):0,Ye=m.stats?.devices_per_second||0,$e=m.stats?.error_count||0;let oe=`âœ… All Devices Pinged Successfully!

Total Devices: ${u}
Online: ${_}
Offline: ${Ze}
Uptime: ${Xe}%
Duration: ${(m.stats?.ping_duration/1e3||0).toFixed(1)}s
Speed: ${Ye} devices/sec`;$e>0&&(oe+=`
Errors: ${$e} (devices marked offline)`),oe+=`

All devices including offline ones have been pinged.`,alert(oe)}}else{const m=await g.text();console.error("Ping all error response:",m);let u="Failed to ping all devices";try{const _=JSON.parse(m);u=_.message||_.error||u}catch{u=m||u}g.status===500&&u.includes("Maximum execution time")&&(u="Ping operation took too long. Try with fewer devices or check server timeout settings."),alert(`âŒ ${u}`)}}catch(s){if(console.error("Error pinging all devices:",s),s instanceof Error&&s.name==="AbortError")alert("âŒ Ping operation timed out. The operation may still be running on the server. Please wait a few minutes and refresh the page to see updated results.");else{const a=s instanceof Error?s.message:"Unknown error occurred";alert(`âŒ Network error while pinging all devices: ${a}`)}}finally{ve(!1)}}},Je=async s=>{we(s);try{const a=await fetch(`/ping-device/${s}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(a.ok){const l=await a.json();te(m=>m.map(u=>u.id===s?{...u,status:l.device.status,response_time:l.device.response_time,last_ping:l.device.last_ping}:u)),t&&t.id===s&&$({...t,status:l.device.status,response_time:l.device.response_time,last_ping:l.device.last_ping});const n=l.device.status==="online"?"ðŸŸ¢":"ðŸ”´",g=l.debug?`

DEBUG INFO:
Ping Command: ${l.debug.ping_command}
Return Code: ${l.debug.return_code}
DB Status: ${l.debug.database_status_after_update}
DB Response Time: ${l.debug.database_response_time_after_update}ms`:"";alert(`${n} ${l.device.name}

Status: ${l.device.status}
Response Time: ${l.device.response_time||"N/A"}ms
Last Ping: ${l.device.last_ping}${g}

Note: Using real ICMP ping`)}else{const l=await a.json();alert(`âŒ Failed to get device status: ${l.error||"Unknown error"}`)}}catch(a){console.error("Error getting device status:",a),alert("âŒ Network error while getting device status")}finally{we(null)}};r.useEffect(()=>{le(1)},[c,v,h,o,p,j,N,w,y]),r.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]);const Z=je,ne=be.length>0?be:[],de=fe.length>0?fe:[],_e=p!=="all"?ee.filter(s=>s.brand_id===parseInt(p)):ee,M=s=>{w===s?ue(y==="asc"?"desc":"asc"):(Pe(s),ue("asc"))},L=Z,Qe=()=>{b(""),q("all"),A("all"),B("all"),E("all"),Y("all"),k("all")},Se=[h,v!=="all",o!=="all",p!=="all",j!=="all",N!=="all",c!=="all"].filter(Boolean).length;return r.useEffect(()=>{if(d?.id){const s=d?.id==="all"?"/api/locations":`/api/locations?branch_id=${d.id}`;fetch(s,{credentials:"same-origin",headers:{Accept:"application/json"}}).then(a=>a.ok?a.json():[]).then(a=>Te(a)).catch(a=>console.error("Error loading locations:",a)),fetch("/api/brands",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(a=>a.ok?a.json():[]).then(a=>Be(a)).catch(a=>console.error("Error loading brands:",a)),fetch("/api/models",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(a=>a.ok?a.json():[]).then(a=>Ee(a)).catch(a=>console.error("Error loading models:",a)),fetch("/api/users",{credentials:"same-origin",headers:{Accept:"application/json"}}).then(a=>a.ok?a.json():[]).then(a=>Oe(a)).catch(a=>console.error("Error loading users:",a))}},[d?.id]),e.jsx(ts,{title:i("devices.title"),children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-xl border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 dark:border-blue-900/30 dark:from-blue-950/20 dark:to-indigo-950/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 p-2 shadow-lg",children:e.jsx(Le,{className:"size-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:d?.name||"No Branch Selected"}),e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[d?.description||"Please select a branch"," â€¢ ",d?.deviceCount||0," devices"]})]})]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-3xl font-bold text-transparent dark:from-white dark:to-slate-300",children:i("devices.title")}),e.jsx("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-400",children:i("devices.subtitle")})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(is,{className:"absolute left-3 top-1/2 size-5 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:i("devices.search"),value:h,onChange:s=>b(s.target.value),className:"w-full rounded-xl border border-slate-200 bg-white py-2.5 pl-10 pr-4 text-sm text-slate-900 placeholder-slate-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white dark:placeholder-slate-500"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:Ke,disabled:re||Re||!d?.id||d?.id==="all",className:"flex items-center gap-2 rounded-lg bg-gradient-to-r from-green-500 to-emerald-600 px-4 py-2 text-sm font-medium text-white shadow-lg transition-all hover:from-green-600 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Ping all devices in current branch",children:[e.jsx(Ae,{className:`size-4 ${re?"animate-spin":""}`}),e.jsx("span",{children:re?"Pinging...":"Ping All"})]}),Q&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-blue-50 px-3 py-2 text-sm text-blue-700 dark:bg-blue-900/20 dark:text-blue-300",children:[e.jsx(ns,{className:"size-4"}),e.jsxs("span",{children:["Last: ",Q.online,"/",Q.total," online"]}),e.jsxs("span",{className:"text-xs",children:["(",Q.duration,"ms)"]})]}),e.jsxs("div",{className:"flex gap-1 rounded-lg border border-slate-200 bg-white p-1 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("button",{onClick:()=>ge("grid"),className:`rounded-md p-2 transition-all ${H==="grid"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-700"}`,title:"Grid View",children:e.jsx(gs,{className:"size-4"})}),e.jsx("button",{onClick:()=>ge("list"),className:`rounded-md p-2 transition-all ${H==="list"?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-700"}`,title:"List View",children:e.jsx(js,{className:"size-4"})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["all","online","warning","offline","offline_ack"].map(s=>e.jsx("button",{onClick:()=>q(s),className:`rounded-lg px-3 py-2 text-sm font-medium transition-all ${v===s?"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700"}`,children:s==="all"?i("devices.all"):s==="offline_ack"?"Acknowledged":s.charAt(0).toUpperCase()+s.slice(1)},s)),e.jsxs("button",{onClick:()=>Ue(!G),className:`flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-all ${G||p!=="all"||j!=="all"||o!=="all"||N!=="all"?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-lg":"border border-slate-200 bg-white text-slate-700 hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700"}`,children:["Advanced Filters",G?e.jsx(z,{className:"size-4"}):e.jsx(C,{className:"size-4"})]}),Se>0&&e.jsxs("button",{onClick:Qe,className:"flex items-center gap-2 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm font-medium text-red-700 hover:bg-red-100 dark:border-red-900/30 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30",children:[e.jsx(F,{className:"size-4"}),"Clear All (",Se,")"]})]}),G&&e.jsxs("div",{className:"rounded-xl border border-slate-200/50 bg-gradient-to-br from-white to-slate-50 p-4 shadow-inner dark:border-slate-700/50 dark:from-slate-800 dark:to-slate-900",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Location"}),e.jsxs("select",{value:o,onChange:s=>A(s.target.value),className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsxs("option",{value:"all",children:["All Locations (",ne.length,")"]}),ne.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:["Filtered by ",d?.name||"current branch"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Brand"}),e.jsxs("select",{value:p,onChange:s=>{B(s.target.value),s.target.value==="all"&&E("all")},className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsxs("option",{value:"all",children:["All Brands (",de.length,")"]}),de.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"From database"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Model"}),e.jsxs("select",{value:j,onChange:s=>E(s.target.value),disabled:p==="all",className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsx("option",{value:"all",children:p==="all"?"Select brand first":`All Models (${_e.length})`}),_e.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:p==="all"?"Dependent on brand":"From database"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Managed By"}),e.jsxs("select",{value:N,onChange:s=>Y(s.target.value),className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white",children:[e.jsxs("option",{value:"all",children:["All Users (",se.length,")"]}),e.jsx("option",{value:"unassigned",children:"Unassigned"}),se.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.role,")"]},s.id))]}),e.jsx("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"Filter by device manager"})]})]}),(p!=="all"||j!=="all"||o!=="all"||N!=="all")&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 border-t border-slate-200 pt-4 dark:border-slate-700",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Active:"}),o!=="all"&&e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-blue-100 px-2 py-1 text-xs font-medium text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",children:["Location: ",ne.find(s=>String(s.id)===o||s.name===o)?.name||o,e.jsx("button",{onClick:()=>A("all"),className:"hover:text-blue-900 dark:hover:text-blue-100",children:e.jsx(F,{className:"size-3"})})]}),p!=="all"&&e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-purple-100 px-2 py-1 text-xs font-medium text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",children:["Brand: ",de.find(s=>String(s.id)===p)?.name||p,e.jsx("button",{onClick:()=>{B("all"),E("all")},className:"hover:text-purple-900 dark:hover:text-purple-100",children:e.jsx(F,{className:"size-3"})})]}),j!=="all"&&e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-pink-100 px-2 py-1 text-xs font-medium text-pink-700 dark:bg-pink-900/30 dark:text-pink-300",children:["Model: ",ee.find(s=>String(s.id)===j)?.name||j,e.jsx("button",{onClick:()=>E("all"),className:"hover:text-pink-900 dark:hover:text-pink-100",children:e.jsx(F,{className:"size-3"})})]}),N!=="all"&&e.jsxs("span",{className:"flex items-center gap-1 rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-700 dark:bg-green-900/30 dark:text-green-300",children:["Managed By: ",N==="unassigned"?"Unassigned":se.find(s=>String(s.id)===N)?.name||N,e.jsx("button",{onClick:()=>Y("all"),className:"hover:text-green-900 dark:hover:text-green-100",children:e.jsx(F,{className:"size-3"})})]})]}),e.jsx("div",{className:"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-900/30 dark:bg-blue-950/20",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(bs,{className:"size-4 text-blue-600 dark:text-blue-400 mt-0.5 shrink-0"}),e.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-300",children:[e.jsx("p",{className:"font-semibold",children:"Advanced Filters"}),e.jsxs("p",{className:"mt-1",children:["â€¢ Location: ",d?.id==="all"?e.jsx(e.Fragment,{children:"Shows locations from all branches"}):e.jsxs(e.Fragment,{children:["Shows locations within ",e.jsx("strong",{children:d?.name||"current branch"})," only"]})]}),e.jsx("p",{children:"â€¢ Brand & Model: Loaded from database configuration"}),e.jsx("p",{children:"â€¢ Select brand to filter available models"})]})]})})]})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:Ge.map(s=>{const a=s.icon,l=c===s.id;return e.jsxs("button",{onClick:()=>k(s.id),className:`group flex flex-col items-center gap-3 rounded-xl border p-4 transition-all hover:scale-105 ${l?"border-blue-500 bg-gradient-to-br from-blue-50 to-indigo-50 shadow-lg dark:border-blue-400 dark:from-blue-950/30 dark:to-indigo-950/30":"border-slate-200 bg-white hover:border-slate-300 hover:shadow-md dark:border-slate-700 dark:bg-slate-800 dark:hover:border-slate-600"}`,title:s.description,children:[e.jsx("div",{className:`rounded-full p-3 transition-all ${l?"bg-gradient-to-br from-blue-500 to-indigo-600 shadow-lg":"bg-slate-100 group-hover:bg-slate-200 dark:bg-slate-700 dark:group-hover:bg-slate-600"}`,children:e.jsx(a,{className:`size-6 ${l?"text-white":"text-slate-600 dark:text-slate-400"}`})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:`text-sm font-bold ${l?"text-blue-900 dark:text-blue-100":"text-slate-900 dark:text-white"}`,children:s.name}),s.description&&e.jsx("p",{className:`mt-1 text-xs line-clamp-2 ${l?"text-blue-700 dark:text-blue-300":"text-slate-500 dark:text-slate-400"}`,children:s.description}),e.jsxs("p",{className:`mt-1 text-xs font-semibold ${l?"text-blue-600 dark:text-blue-400":"text-slate-500 dark:text-slate-400"}`,children:[s.count," ",i("common.devices")]})]})]},s.id)})}),L.length===0&&e.jsxs("div",{className:"rounded-2xl border border-slate-200/50 bg-white p-12 text-center shadow-lg dark:border-slate-700/50 dark:bg-slate-800",children:[e.jsx(Fe,{className:"mx-auto mb-4 size-12 text-slate-400"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:i("devices.noDevices")}),e.jsx("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-400",children:i(h||v!=="all"||c!=="all"||o!=="all"||p!=="all"||j!=="all"||N!=="all"?"devices.tryAdjustingFilters":"devices.noDevicesConfigured")})]}),H==="grid"&&L.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c!=="all"&&(()=>{if(V.find(a=>a.id===c)){const a=R(c);return e.jsx("div",{className:"rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 p-2 shadow-lg",children:e.jsx(a,{className:"size-5 text-white"})})}return null})(),c==="all"&&e.jsx("div",{className:"rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600 p-2 shadow-lg",children:e.jsx(X,{className:"size-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-slate-900 dark:text-white",children:V.find(s=>s.id===c)?.name||"All Devices"})]}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Showing ",Z.length," device",Z.length!==1?"s":""," on this page",S>0&&e.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(Total: ",S," device",S!==1?"s":""," matching filters across all pages)"]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3 text-xs",children:[e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:x.tiny,onChange:s=>O(a=>({...a,tiny:s.target.checked}))}),"Smallest"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:x.dense,onChange:s=>O(a=>({...a,dense:s.target.checked}))}),"Dense"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:x.showName,onChange:s=>O(a=>({...a,showName:s.target.checked}))}),"Name"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:x.showIp,onChange:s=>O(a=>({...a,showIp:s.target.checked}))}),"IP"]}),e.jsxs("label",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[e.jsx("input",{type:"checkbox",checked:x.showStatus,onChange:s=>O(a=>({...a,showStatus:s.target.checked}))}),"Status"]})]})]}),(()=>{const s=Z.reduce((l,n)=>{const g=n.location_name||(typeof n.location=="string"?n.location:null)||n.location?.name||"No Location";return l[g]||(l[g]=[]),l[g].push(n),l},{}),a=Object.keys(s).sort();return e.jsx("div",{className:"space-y-6",children:a.map(l=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-900 dark:text-slate-100",children:l}),e.jsx("div",{className:"mt-1 border-b border-slate-200 dark:border-slate-700"})]}),e.jsx("div",{className:`grid ${x.tiny?"grid-cols-6 sm:grid-cols-8 md:grid-cols-12 lg:grid-cols-16 xl:grid-cols-20 2xl:grid-cols-24 gap-1":x.dense?"grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 xl:grid-cols-12 2xl:grid-cols-14 gap-1.5":"grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-10 gap-3"}`,children:s[l].map(n=>e.jsx("div",{className:`group cursor-pointer ${x.tiny?"rounded sm:rounded":"rounded-md"} border border-transparent bg-white ${x.tiny?"shadow-none":"shadow"} ${x.tiny?"":"hover:shadow-lg"} transition-all ${x.tiny?"":"hover:scale-105"} dark:bg-slate-800 ${x.tiny?"p-0.5":x.dense?"p-1.5":"p-2.5"} overflow-hidden`,onClick:()=>{$(n),he(n.id)},children:e.jsxs("div",{className:"flex flex-col items-center text-center w-full min-w-0",children:[e.jsx("div",{className:`${x.tiny?"mb-0":"mb-0.5"} ${x.tiny?"rounded":"rounded-md"} border border-transparent ${x.tiny?"p-0.5":x.dense?"p-1":"p-1.5"} transition-transform ${x.tiny?"":"group-hover:scale-110"} ${U(n.status)} flex-shrink-0`,children:(()=>{const g=R(n.category||"");return e.jsx(g,{className:`${x.tiny||x.dense?"size-3":"size-4"} ${P(n.status)}`})})()}),x.showName&&e.jsx("h3",{className:`${x.tiny?"mt-0.5 text-[9px]":"mb-0 text-[10px]"} font-medium text-slate-900 dark:text-slate-200 line-clamp-1 w-full min-w-0 px-0.5 overflow-hidden text-ellipsis`,children:n.name}),!x.tiny&&x.showIp&&e.jsx("div",{className:"mt-0.5 text-[10px] text-slate-500 dark:text-slate-400 line-clamp-1 w-full min-w-0 px-0.5 overflow-hidden text-ellipsis",children:n.ip_address}),!x.tiny&&x.showStatus&&e.jsx("div",{className:"mt-0.5 text-[10px] w-full min-w-0 px-0.5",children:e.jsx("span",{className:`rounded px-1.5 py-0.5 ${U(n.status)} ${P(n.status)} inline-block line-clamp-1 overflow-hidden text-ellipsis`,children:me(n.status)})})]})},n.id))})]},l))})})(),e.jsx(Me,{currentPage:K,totalPages:Ne,totalItems:S,perPage:J,onPageChange:le,onPerPageChange:ke})]}),H==="list"&&L.length>0&&e.jsxs("div",{className:"rounded-2xl border border-slate-200/50 bg-white shadow-lg dark:border-slate-700/50 dark:bg-slate-800 overflow-hidden",children:[e.jsx("div",{className:"border-b border-slate-200/50 bg-gradient-to-r from-slate-50 to-slate-100 p-6 dark:border-slate-700/50 dark:from-slate-900/50 dark:to-slate-800/50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[c!=="all"&&(()=>{const s=R(c);return e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 p-3 shadow-lg",children:e.jsx(s,{className:"size-6 text-white"})})})(),c==="all"&&e.jsx("div",{className:"rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 p-3 shadow-lg",children:e.jsx(X,{className:"size-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:V.find(s=>s.id===c)?.name||"All Devices"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Showing ",L.length," device",L.length!==1?"s":""," on this page",S>0&&e.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:["(Total: ",S," device",S!==1?"s":""," matching filters across all pages)"]})]})]})]})}),e.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:e.jsxs("table",{className:"w-full min-w-[800px] sm:min-w-0",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>M("name"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Name",w==="name"?y==="asc"?e.jsx(z,{className:"size-4"}):e.jsx(C,{className:"size-4"}):e.jsx(I,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>M("ip_address"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["IP Address",w==="ip_address"?y==="asc"?e.jsx(z,{className:"size-4"}):e.jsx(C,{className:"size-4"}):e.jsx(I,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>M("uptime_percentage"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Uptime",w==="uptime_percentage"?y==="asc"?e.jsx(z,{className:"size-4"}):e.jsx(C,{className:"size-4"}):e.jsx(I,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>M("status"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Status",w==="status"?y==="asc"?e.jsx(z,{className:"size-4"}):e.jsx(C,{className:"size-4"}):e.jsx(I,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left",children:e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:"Last Ping"})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>M("location"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Location",w==="location"?y==="asc"?e.jsx(z,{className:"size-4"}):e.jsx(C,{className:"size-4"}):e.jsx(I,{className:"size-4 opacity-30"})]})}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",onClick:()=>M("brand"),children:e.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-wider text-slate-700 dark:text-slate-300",children:["Brand/Model",w==="brand"?y==="asc"?e.jsx(z,{className:"size-4"}):e.jsx(C,{className:"size-4"}):e.jsx(I,{className:"size-4 opacity-30"})]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200/50 dark:divide-slate-700/50",children:L.map(s=>e.jsxs("tr",{className:"cursor-pointer transition-colors hover:bg-slate-50 dark:hover:bg-slate-700/50",onClick:()=>{$(s),he(s.id)},children:[e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`rounded-lg border p-2 ${U(s.status)}`,children:(()=>{const a=R(s.category||"");return e.jsx(a,{className:`size-4 ${P(s.status)}`})})()}),e.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-white",children:s.name})]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400 font-mono",children:s.ip_address})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400",children:[e.jsx(ce,{className:"size-4"}),xe(s.uptime_minutes)]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-xs font-medium ${U(s.status)} ${P(s.status)}`,children:[De(s.status),me(s.status)]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:s.last_ping?new Date(s.last_ping).toLocaleString():"Never"})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:s.latitude&&s.longitude?e.jsxs("button",{onClick:a=>{a.stopPropagation();const l=new URLSearchParams;s.location_id&&l.set("location_id",String(s.location_id)),l.set("deviceId",String(s.id)),Ce.visit(`/monitor/plan?${l.toString()}`)},className:"flex items-center gap-1.5 rounded-lg bg-blue-100 px-2 py-1 text-blue-700 transition-all hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50",title:"Open floor plan",children:[e.jsx(ze,{className:"size-3.5"}),e.jsx("span",{className:"text-xs font-medium",children:s.location})]}):e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:s.location})}),e.jsx("td",{className:"px-3 sm:px-6 py-4",children:s.brand&&s.model?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:s.brand}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:s.model})]}):e.jsx("span",{className:"text-slate-400 dark:text-slate-600",children:"-"})})]},s.id))})]})}),e.jsx(Me,{currentPage:K,totalPages:Ne,totalItems:S,perPage:J,onPageChange:le,onPerPageChange:ke})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/90 backdrop-blur-md",onClick:()=>$(null)}),e.jsxs("div",{className:"fixed left-1/2 top-1/2 z-50 w-full max-w-2xl -translate-x-1/2 -translate-y-1/2 overflow-hidden rounded-2xl border border-slate-200/50 bg-white shadow-2xl dark:border-slate-700/50 dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200/50 p-6 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`rounded-xl border p-3 ${U(t.status)}`,children:(()=>{const s=R(t.category||"");return e.jsx(s,{className:`size-6 ${P(t.status)}`})})()}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:t.ip_address})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:s=>{s.stopPropagation(),Je(t.id)},disabled:ie===t.id,className:"flex items-center gap-2 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-lg transition-all hover:from-blue-600 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Ping this device",children:[e.jsx(Ae,{className:`size-4 ${ie===t.id?"animate-spin":""}`}),e.jsx("span",{children:ie===t.id?"Pinging...":"Ping Device"})]}),e.jsx("button",{onClick:()=>$(null),className:"rounded-lg p-2 text-slate-500 transition-all hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800",children:e.jsx(F,{className:"size-5"})})]})]}),e.jsx("div",{className:"max-h-[70vh] overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Status"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`flex items-center gap-2 rounded-full px-3 py-1 text-sm font-medium ${U(t.status)} ${P(t.status)}`,children:[De(t.status),me(t.status)]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Uptime"}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[e.jsx(ce,{className:"size-4"}),e.jsx("span",{className:"text-lg font-semibold",children:xe(t.uptime_minutes)})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Response Time"}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-700 dark:text-slate-300",children:[e.jsx(Ns,{className:"size-4"}),e.jsx("span",{className:"text-lg font-semibold",children:t.response_time?`${t.response_time}ms`:"N/A"}),t.response_time&&t.response_time>100&&e.jsx("span",{className:"rounded-full bg-yellow-100 px-2 py-0.5 text-xs font-medium text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",children:"High"})]})]}),t.status==="offline"&&e.jsx(e.Fragment,{children:t.offline_duration_minutes!==void 0&&t.offline_duration_minutes>0&&e.jsxs("div",{className:"rounded-xl bg-orange-50 p-4 dark:bg-orange-950/20",children:[e.jsx("h3",{className:"mb-2 text-sm font-semibold text-orange-900 dark:text-orange-300",children:"Offline Duration"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"size-4 text-orange-600 dark:text-orange-400"}),e.jsxs("span",{className:"text-lg font-semibold text-orange-700 dark:text-orange-400",children:[t.offline_duration_minutes," minute",t.offline_duration_minutes!==1?"s":""]}),t.offline_duration_minutes>=2&&e.jsx("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-medium text-red-700 dark:bg-red-900/30 dark:text-red-400",children:"Alert Triggered"})]}),t.offline_since&&e.jsxs("p",{className:"mt-2 text-xs text-orange-600 dark:text-orange-400",children:["Offline since: ",new Date(t.offline_since).toLocaleString()]})]})}),t.status==="offline"&&e.jsx("div",{className:"rounded-xl bg-red-50 p-4 dark:bg-red-950/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(W,{className:"size-5 text-red-600 dark:text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-700 dark:text-red-400",children:"Device Offline"}),e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:"This device is currently offline and not responding to monitoring requests."})]})]})}),t.status==="offline_ack"&&t.offline_reason&&e.jsx("div",{className:"rounded-xl bg-blue-50 p-4 dark:bg-blue-950/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ie,{className:"size-5 text-blue-600 dark:text-blue-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-blue-700 dark:text-blue-400",children:"Offline - Acknowledged"}),e.jsxs("div",{className:"mt-3 rounded-lg border border-blue-200 bg-white p-3 dark:border-blue-900/30 dark:bg-blue-950/30",children:[e.jsx("p",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300",children:"Reason:"}),e.jsx("p",{className:"mt-1 text-sm text-blue-900 dark:text-blue-200",children:t.offline_reason}),t.offline_acknowledged_by&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-blue-600 dark:text-blue-400",children:[e.jsx(ds,{className:"size-3"}),e.jsxs("span",{children:["Acknowledged by ",t.offline_acknowledged_by]}),t.offline_acknowledged_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:new Date(t.offline_acknowledged_at).toLocaleString()})]})]})]})]})]})}),t.status==="warning"&&e.jsx("div",{className:"rounded-xl bg-yellow-50 p-4 dark:bg-yellow-950/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(W,{className:"size-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-yellow-700 dark:text-yellow-400",children:"Device Warning"}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx("div",{className:"rounded-lg border border-yellow-200 bg-white p-3 dark:border-yellow-900/30 dark:bg-yellow-950/30",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-yellow-700 dark:text-yellow-300",children:"Response Time:"}),e.jsxs("span",{className:"font-bold text-yellow-900 dark:text-yellow-200",children:[t.response_time?`${t.response_time}ms`:"N/A",t.response_time&&t.response_time>100&&e.jsx("span",{className:"ml-2 text-xs",children:"(High)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-yellow-700 dark:text-yellow-300",children:"Uptime:"}),e.jsx("span",{className:"font-bold text-yellow-900 dark:text-yellow-200",children:xe(t.uptime_minutes)})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-yellow-700 dark:text-yellow-300",children:"Last Check:"}),e.jsx("span",{className:"font-medium text-yellow-900 dark:text-yellow-200",children:t.last_check?new Date(t.last_check).toLocaleString():"Never"})]})]})}),e.jsxs("div",{className:"rounded-lg bg-yellow-100 p-3 dark:bg-yellow-900/20",children:[e.jsx("p",{className:"text-xs font-semibold text-yellow-800 dark:text-yellow-300",children:"Possible Issues:"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-700 dark:text-yellow-400",children:[t.response_time&&t.response_time>100&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 size-1 rounded-full bg-yellow-600 dark:bg-yellow-400"}),e.jsx("span",{children:"High response time detected - Network congestion or device overload"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 size-1 rounded-full bg-yellow-600 dark:bg-yellow-400"}),e.jsx("span",{children:"Device requires attention - Monitor closely for potential failures"})]})]})]}),e.jsxs("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:[e.jsx("p",{className:"font-medium",children:"Recommended Action:"}),e.jsx("p",{className:"mt-1",children:"Schedule maintenance check or investigate network connectivity to prevent potential downtime."})]})]})]})]})}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-4 dark:bg-slate-800",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Device Information"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Category:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:V.find(s=>s.id===t.category)?.name})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"IP Address:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white font-mono",children:t.ip_address})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"MAC Address:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white font-mono",children:t.mac_address})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Barcode:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ps,{className:"size-4 text-slate-500 dark:text-slate-400"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white font-mono",children:t.barcode})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Serial Number:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white font-mono",children:t.serial_number||"-"})]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Managed By:"}),e.jsx("div",{className:"text-right",children:t.managed_by_user?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:t.managed_by_user.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:t.managed_by_user.email}),e.jsx("span",{className:`mt-1 inline-flex rounded-full px-2 py-0.5 text-xs font-medium ${t.managed_by_user.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}`,children:t.managed_by_user.role}),Array.isArray(t.managed_by_users)&&t.managed_by_users.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:t.managed_by_users.map(s=>e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s.email}),e.jsx("span",{className:`mt-1 inline-flex rounded-full px-2 py-0.5 text-xs font-medium ${s.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}`,children:s.role})]},s.id))})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-slate-400 dark:text-slate-600",children:"Not assigned"}),Array.isArray(t.managed_by_users)&&t.managed_by_users.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:t.managed_by_users.map(s=>e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 dark:text-white",children:s.name}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:s.email}),e.jsx("span",{className:`mt-1 inline-flex rounded-full px-2 py-0.5 text-xs font-medium ${s.role==="admin"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}`,children:s.role})]},s.id))})]})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Response Time:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:t.response_time?`${t.response_time}ms`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Last Ping:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:t.last_ping?new Date(t.last_ping).toLocaleString():"Never"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Last Changed:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:t.updated_at?new Date(t.updated_at).toLocaleString():"Never"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Location:"}),e.jsxs("button",{onClick:()=>{$(null),Ce.visit("/monitor/maps",{data:{deviceId:t.id,lat:t.latitude,lng:t.longitude}})},className:"flex items-center gap-1.5 rounded-lg bg-blue-100 px-3 py-1.5 text-blue-700 transition-all hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50",children:[e.jsx(ze,{className:"size-3.5"}),e.jsx("span",{className:"font-medium",children:t.location})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Brand/Model:"}),t.brand&&t.model?e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm font-bold text-slate-900 dark:text-white",children:t.brand}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:t.model})]}):e.jsx("span",{className:"text-slate-400 dark:text-slate-600",children:"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Device ID:"}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:t.id})]})]})]}),e.jsxs("div",{className:"rounded-xl bg-slate-50 p-4 dark:bg-slate-800",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold text-slate-900 dark:text-white",children:"Comments"}),e.jsx(vs,{deviceId:t.id})]})]})})]})]})]})})}function vs({deviceId:i}){const[f,d]=r.useState([]),[c,k]=r.useState(!1),h=r.useCallback(async()=>{k(!0);try{const b=await fetch(`/devices/${i}/comments`);if(b.ok){const v=await b.json();d(v.comments)}}catch(b){console.error("Error fetching comments:",b)}finally{k(!1)}},[i]);return r.useEffect(()=>{h()},[h]),c?e.jsx("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading comments..."}):f.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No comments yet for this device."}):e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:f.map(b=>e.jsxs("div",{className:"rounded-lg bg-slate-50 p-4 border border-slate-200 dark:bg-slate-700 dark:border-slate-600",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${b.type==="maintenance"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400":b.type==="issue"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":b.type==="note"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-400"}`,children:b.type}),e.jsx("span",{className:"font-medium text-sm text-slate-900 dark:text-white",children:b.author})]}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:new Date(b.created_at).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap",children:b.comment})]},b.id))})}function Me({currentPage:i,totalPages:f,totalItems:d,perPage:c,onPageChange:k,onPerPageChange:h}){const b=(i-1)*c+1,v=Math.min(i*c,d),q=()=>{const o=[];if(f<=5)for(let p=1;p<=f;p++)o.push(p);else{o.push(1),i>3&&o.push("...");const p=Math.max(2,i-1),B=Math.min(f-1,i+1);for(let j=p;j<=B;j++)o.push(j);i<f-2&&o.push("..."),o.push(f)}return o};return f<=1?null:e.jsxs("div",{className:"flex items-center justify-between border-t border-slate-200 bg-white px-4 py-3 dark:border-slate-700 dark:bg-slate-800 sm:px-6",children:[e.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>k(i-1),disabled:i===1,className:"relative inline-flex items-center rounded-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200",children:"Previous"}),e.jsx("button",{onClick:()=>k(i+1),disabled:i===f,className:"relative ml-3 inline-flex items-center rounded-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:["Showing ",e.jsx("span",{className:"font-medium",children:b})," to ",e.jsx("span",{className:"font-medium",children:v})," of"," ",e.jsx("span",{className:"font-medium",children:d})," results"]}),e.jsxs("select",{value:c,onChange:o=>h(Number(o.target.value)),className:"rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200",children:[e.jsx("option",{value:300,children:"300 per page"}),e.jsx("option",{value:500,children:"500 per page"}),e.jsx("option",{value:800,children:"800 per page"}),e.jsx("option",{value:1e3,children:"1000 per page"})]})]}),e.jsx("div",{children:e.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[e.jsxs("button",{onClick:()=>k(i-1),disabled:i===1,className:"relative inline-flex items-center rounded-l-md px-2 py-2 text-slate-400 ring-1 ring-inset ring-slate-300 hover:bg-slate-50 disabled:opacity-50 dark:ring-slate-600 dark:hover:bg-slate-700",children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx(as,{className:"size-5"})]}),q().map((o,A)=>o==="..."?e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-slate-700 ring-1 ring-inset ring-slate-300 dark:text-slate-300 dark:ring-slate-600",children:"..."},`ellipsis-${A}`):e.jsx("button",{onClick:()=>k(o),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ring-1 ring-inset ring-slate-300 dark:ring-slate-600 ${i===o?"z-10 bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-slate-900 hover:bg-slate-50 dark:text-slate-100 dark:hover:bg-slate-700"}`,children:o},o)),e.jsxs("button",{onClick:()=>k(i+1),disabled:i===f,className:"relative inline-flex items-center rounded-r-md px-2 py-2 text-slate-400 ring-1 ring-inset ring-slate-300 hover:bg-slate-50 disabled:opacity-50 dark:ring-slate-600 dark:hover:bg-slate-700",children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx(os,{className:"size-5"})]})]})})]})]})}export{Es as default};
